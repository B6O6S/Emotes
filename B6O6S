-- LocalScript in StarterPlayerScripts

--=== CONFIG ===--
local emotes = {
    {id = 113855231967763, name = "Take the L"},
    {id = 82250025202656, name = "Can I Join?"},
    {id = 101397505086633, name = "Lonely Lonely"},
    {id = 91811231498287, name = "Rampage"},
    {id = 14353423348, name = "Wall Glitch"},
    {id = 15610015346, name = "Speed Glitch"},
    {id = 132950274861655, name = "Worm Dance"},
    {id = 93738573538058, name = "Push Up"},
    {id = 92237689732858, name = "Stomp"},
    {id = 79414723643986, name = "Toxic Laugh"},
    {id = 85488100591241, name = "Gangam Style"},
    {id = 99326825873329, name = "Tidy"},
    {id = 71210290786350, name = "Rollie"},
    {id = 122687759897103, name = "Sturdy"}
}

--=== SERVICES ===--
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local UIS = game:GetService("UserInputService")

--=== HELPER: Draggable Function ===--
local function makeDraggable(gui)
    local dragging, dragInput, dragStart, startPos

    gui.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = gui.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    gui.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UIS.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            gui.Position = UDim2.new(
                startPos.X.Scale, startPos.X.Offset + delta.X,
                startPos.Y.Scale, startPos.Y.Offset + delta.Y
            )
        end
    end)
end

--=== MAIN GUI ===--
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "EmoteMenu"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 250, 0, 300)
mainFrame.Position = UDim2.new(0.5, -125, 0.5, -150)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.Active = true
mainFrame.Parent = screenGui
makeDraggable(mainFrame)

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 8)
uiCorner.Parent = mainFrame

local toggleBtn = Instance.new("TextButton")
toggleBtn.Text = "X"
toggleBtn.Size = UDim2.new(0, 30, 0, 30)
toggleBtn.Position = UDim2.new(1, -35, 0, 5)
toggleBtn.Parent = mainFrame

--=== SCROLLING FRAME ===--
local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Size = UDim2.new(1, -10, 1, -40)
scrollFrame.Position = UDim2.new(0, 5, 0, 35)
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.ScrollBarThickness = 6
scrollFrame.BackgroundTransparency = 1
scrollFrame.Parent = mainFrame

local listLayout = Instance.new("UIListLayout")
listLayout.Parent = scrollFrame
listLayout.SortOrder = Enum.SortOrder.LayoutOrder
listLayout.Padding = UDim.new(0, 5)

--=== SHORTCUTS HOLDER ===--
local shortcutFolder = Instance.new("Folder")
shortcutFolder.Name = "Shortcuts"
shortcutFolder.Parent = screenGui

--=== FUNCTION: Play Emote ===--
local function playEmote(id)
    local char = player.Character or player.CharacterAdded:Wait()
    local hum = char:FindFirstChildOfClass("Humanoid")
    if hum then
        hum:PlayEmote(id)
    end
end

--=== FUNCTION: Create Shortcut ===--
local function createShortcut(emote)
    if shortcutFolder:FindFirstChild(emote.name) then
        shortcutFolder[emote.name]:Destroy()
        return
    end

    local btn = Instance.new("TextButton")
    btn.Name = emote.name
    btn.Text = emote.name
    btn.Size = UDim2.new(0, 100, 0, 30)
    btn.Position = UDim2.new(0.5, -50, 0, 50)
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.Parent = shortcutFolder
    makeDraggable(btn)

    btn.MouseButton1Click:Connect(function()
        playEmote(emote.id)
    end)
end

--=== POPULATE MAIN GUI ===--
for _, emote in ipairs(emotes) do
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, -5, 0, 50)
    frame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    frame.Parent = scrollFrame

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = frame

    local thumb = Instance.new("ImageLabel")
    thumb.Size = UDim2.new(0, 50, 0, 50)
    thumb.Image = ("rbxthumb://type=Asset&id=%d&w=420&h=420"):format(emote.id)
    thumb.BackgroundTransparency = 1
    thumb.Parent = frame

    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, -60, 1, 0)
    nameLabel.Position = UDim2.new(0, 55, 0, 0)
    nameLabel.Text = emote.name
    nameLabel.BackgroundTransparency = 1
    nameLabel.TextColor3 = Color3.new(1, 1, 1)
    nameLabel.TextXAlignment = Enum.TextXAlignment.Left
    nameLabel.Parent = frame

    local playBtn = Instance.new("TextButton")
    playBtn.Size = UDim2.new(0, 40, 0, 40)
    playBtn.Position = UDim2.new(1, -90, 0.5, -20)
    playBtn.Text = "â–¶"
    playBtn.Parent = frame

    local shortcutBtn = Instance.new("TextButton")
    shortcutBtn.Size = UDim2.new(0, 40, 0, 40)
    shortcutBtn.Position = UDim2.new(1, -45, 0.5, -20)
    shortcutBtn.Text = "+"
    shortcutBtn.Parent = frame

    playBtn.MouseButton1Click:Connect(function()
        playEmote(emote.id)
    end)

    shortcutBtn.MouseButton1Click:Connect(function()
        createShortcut(emote)
    end)
end

-- Update scroll size
listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y)
end)

--=== TOGGLE MAIN MENU ===--
toggleBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
end)
